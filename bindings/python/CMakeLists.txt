FIND_PACKAGE(PythonInstDir)
FIND_PACKAGE (SWIG REQUIRED)
INCLUDE (UseSWIG)

IF (NOT PYTHON_DESIRED)
    SET (PYTHON_DESIRED "3")
ENDIF ()

IF (${PYTHON_DESIRED} STREQUAL "2")
    MESSAGE ("Building for python2")
    FIND_PACKAGE (PythonInterp 2 REQUIRED)
    FIND_PACKAGE (PythonLibs 2 REQUIRED)
ELSEIF (${PYTHON_DESIRED} STREQUAL "3")
    MESSAGE ("Building for python3")
    FIND_PACKAGE (PythonInterp 3 REQUIRED)
    FIND_PACKAGE (PythonLibs 3 REQUIRED)
ELSE ()
    MESSAGE (FATAL_ERROR "Invalid PYTHON_DESIRED value: " ${PYTHON_DESIRED})
ENDIF ()

FIND_PACKAGE(PythonInstDir)

INCLUDE_DIRECTORIES (${CMAKE_SOURCE_DIR})
INCLUDE_DIRECTORIES (${PYTHON_INCLUDE_PATH})
INCLUDE (UseSWIG)

SET (CONFIG_NAME "conf")

SET_SOURCE_FILES_PROPERTIES (../swig/${CONFIG_NAME}.i PROPERTIES CPLUSPLUS ON)
SWIG_ADD_MODULE (${CONFIG_NAME} python ../swig/${CONFIG_NAME}.i)
SWIG_LINK_LIBRARIES (${CONFIG_NAME} libdnf)
SWIG_LINK_LIBRARIES (${CONFIG_NAME} ${PYTHON_LIBRARY})

INSTALL (FILES __init__.py DESTINATION ${PYTHON_INSTALL_DIR}/libdnf)

INSTALL (TARGETS _${CONFIG_NAME} LIBRARY DESTINATION ${PYTHON_INSTALL_DIR}/libdnf)
INSTALL (FILES ${CMAKE_BINARY_DIR}/bindings/python/${CONFIG_NAME}.py DESTINATION ${PYTHON_INSTALL_DIR}/libdnf)
